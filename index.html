<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8" />
  <title>360¬∞ –í–∏—Ä—Ç—É–∞–ª –∞—è–ª–∞–ª</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

  <!-- Panolens (optional, remove if you only want layout) -->
<!-- THREE first -->
  <script src="https://pchen66.github.io/js/three/three.min.js"></script>

  <!-- Add this small script BEFORE panolens -->
  <script>
    // Minimal polyfill so panolens doesn't crash on "process"
    window.process = {
      env: {
        NODE_ENV: 'production',
        npm_lifecycle_event: ''   // anything that's NOT "test" is fine
      }
    };
  </script>

  <!-- Now load Panolens -->
  <script src="https://cdn.jsdelivr.net/npm/panolens@0.12.1/build/panolens.min.js"></script>


  <style>
    :root {
      --hdr-col:white;
      --blue: #1f6fff;
      --blue-soft: #e7f0ff;
      --green: #00b25c;
      --bg-page: #f2f2f2;
      --bg-card: #ffffff;
      --bg-glass: hsla(0, 0%, 85%, 0.5);
      --grey-soft: #f3f4f6;
      --border-col: white;
      --grey-dark: #6b7280;
      --border-soft: #dde3ed;
      --font-sans: system-ui, -apple-system, BlinkMacSystemFont, "Inter", sans-serif;
      --shadow-ui: 0 10px 30px rgba(0, 0, 0, 0.35);
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: var(--font-sans);
      background: var(--bg-page);
    }

    h2{color:var(--hdr-col); margin:0px; font-family: 'raleway'; font-size: 20px; font-weight: 600;}

    #viewer {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
    }

    .tour-overlay {
      position: absolute;
      inset: 0;
      pointer-events: none; /* let panolens capture drag */
    }

    /* generic buttons */

    .chip {
      pointer-events: auto;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 18px;
      border-radius: 999px;
      border: none;
      font-size: 13px;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.35);
      white-space: nowrap;
    }

    .chip--green {
      background: var(--green);
    }

    .chip--blue {
      background: var(--blue);
    }

    .chip__icon {
      font-size: 14px;
      line-height: 1;
    }

    .panolens-setting {
  background: rgba(15, 23, 42, 0.9);
  border-radius: 12px;
  color: #fff;
}

    /* top bar */

    #out{
      position: absolute;
      top:2%;
      left:2%;
    }

        .glass-top-center{
            position: absolute;
            left: 40%;
            top:2%;
            display: flex;
            width: 306px;
            height: 46px;
            background-color: var(--bg-glass);
            border-radius: 45px;
            border: 1px solid var(--border-col);
            align-items: center;
            justify-content: center;
            
          .ui-top-center {
                display: flex;
                width: 293px;
                height:31px;
                gap:6px;
                justify-content: center;
                align-items: center;
                pointer-events: none;
                background-color: var(--blue);
                border-radius: 50px;
                border: 2px solid var(--border-col);
            }
    }

    .static{
      position: absolute;
      top: 1%;
      right: 1%;
      width: 64px;
      height: 64px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

          .glass-icon-round{

            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid var(--border-col);
            background-color: var(--bg-glass);
            & > .icon-round {
              width: 40px;
              height: 40px;
              border-radius: 999px;
              border: 2px solid var(--border-col);
              background-color: var(--blue);
              display: flex;
              align-items: center;
              justify-content: center;
              color: #fff;
              pointer-events: auto;
              cursor: pointer;
              label{
                display: flex;
                justify-content: center;
                align-items: center;
              }
              input{
                display: none;
              }
            }
        }

        .glass-icon-round:hover{
          width: 60px;
          height: 60px;
          background-color: var();
        }

        

    .icon-round label {
    width: 100%;
    height: 100%;
    display: block;
    cursor: pointer;
  }

    


    .ui-top-center .chip {
      pointer-events: auto;
    }

    /* center cards */

    .ui-center {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -45%);
      pointer-events: auto;
    }

    .card-row {
      display: flex;
      gap: 24px;
    }

    .scene-card {
      width: 170px;
      background: var(--bg-card);
      border-radius: 18px;
      overflow: hidden;
      border: 3px solid #ffffff;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.45);
      cursor: pointer;
      transition: transform 120ms ease-out, box-shadow 120ms ease-out, border-color 120ms ease-out;
    }

    .scene-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 14px 36px rgba(0, 0, 0, 0.55);
    }

    .scene-card--active {
      border-color: var(--blue);
    }

    .scene-card__img {
      width: 100%;
      height: 100px;
      object-fit: cover;
      border-bottom: 1px solid var(--border-soft);
    }

    .scene-card__label {
      padding: 8px 10px 10px;
      background: var(--blue);
      color: #fff;
      text-align: center;
      font-size: 13px;
      font-weight: 600;
    }

    /* bottom area */

    .ui-bottom {
      position: absolute;
      left: 24px;
      right: 24px;
      bottom: 18px;
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      & > .walk-panel {
        & > .glass-panel {
          display: flex;  
          width: 233px;
          height: 51px;
          background-color: var(--bg-glass);
          border: 1px solid var(--border-col);
          border-radius: 50px;
          justify-content: center;
          align-items: center;
          & > .walk{
            width: 219px;
            height: 39px;
            display: flex;
            justify-content: center;
            pointer-events: auto;
            cursor: pointer;
            border: 2px solid var(--border-col);
            align-items: center;
            border-radius: 999px;
            background: var(--blue);
            color: #fff;
            font-size: 13px;
            font-weight: 600;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.4);
            gap: 6px;
          }

          & > .walk-toggle {
            position: absolute;
            opacity: 0;
            pointer-events: none; /* just to be safe */
          }

          /* optional: change style when checked */
          & > .walk-toggle:checked + .walk {
            background: #00b25c; /* —ç—Å–≤—ç–ª ”©”©—Ä ”©–Ω–≥”©: "–∏–¥—ç–≤—Ö—Ç—ç–π" —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞ */
          }
        }
        & > .glass-map {
        width: 233px;
        height: 150px;
        background: var(--bg-glass);
        border-radius: 22px;
        border: 1px solid var(--border-col);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        box-shadow: 0 10px 24px rgba(0, 0, 0, 0.45);
        pointer-events: auto;
        }

        .map {
        width: 170px;
        height: 120px;
        border-radius: 14px;
        background: #e5e5e5;
        border: 3px solid var(--blue);
        position: relative;
        }
    /* mini map & "–Ø–≤–∞—Ö" */
        .floor {
        position:absolute;
        top: 85%;
        z-index: 1;
        align-self: center;
        padding: 3px 16px;
        border-radius: 8px;
        background: #ffffff;
        border: 2px solid var(--blue);
        font-size: 12px;
        color: var(--blue);
        font-weight: 600;
        }
    }
    }
    

    /* big circle on the right */
    .glass-circle{
      width: 170px;
      background-color: var(--bg-glass);
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 50%;
      border: 1px solid var(--border-col);
      height: 170px;
      .nav-circle {
        pointer-events: auto;
        width: 155px;
        height: 155px;
        border-radius: 999px;
        background: #e5e7eb;
        border: 5px solid var(--blue);
        box-shadow: 0 10px 26px rgba(0, 0, 0, 0.5);
      }
    }

    /* subtitle + CC */


    .video-controls {
      position: absolute;
      left: 50%;
      bottom: 70px;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      align-items: center;
      background: rgba(15, 23, 42, 0.85);
      border-radius: 999px;
      padding: 6px 14px;
      border: 1px solid var(--border-col);
      box-shadow: var(--shadow-ui);
      pointer-events: auto;
      color: #fff;
      font-size: 13px;
      z-index: 30;
    }

    .video-controls.hidden {
      display: none;
    }

    .vc-btn {
      border: none;
      outline: none;
      padding: 4px 10px;
      border-radius: 999px;
      background: var(--blue);
      color: #fff;
      cursor: pointer;
      font-size: 12px;
      font-weight: 600;
      white-space: nowrap;
    }

    .vc-btn:hover {
      filter: brightness(1.1);
    }

    .vc-skip {
      background: var(--green);
    }

    .vc-label {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
    }

    #vcSpeed {
      border-radius: 999px;
      border: none;
      padding: 2px 6px;
      font-size: 12px;
    }

    .subtitle {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: 20px;
      background: rgba(0, 0, 0, 0.5);
      color: #fff;
      padding: 6px 14px;
      border-radius: 999px;
      font-size: 13px;
      pointer-events: none;
    }

    .cc-button-wrapper {
      position: absolute;
      top: 93%;
      left: 96%;
      right: 26px;
      bottom: 22px;
      pointer-events: auto;
    }

    .cc-button {
      width: 46px;
      height: 36px;
      padding: 0;
      background: #bfbfbf;
      border-radius: 10px;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      cursor: pointer;
    }

    .cc-button__inner {
      width: 34px;
      height: 26px;
      border-radius: 8px;
      background: #fff;
      border: 3px solid var(--blue);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      font-weight: 700;
      color: var(--blue);
    }

    /* responsive tweaks */

    @media (max-width: 900px) {
      .tour-frame { max-width: 1000px; }
      .scene-card { width: 140px; }
      .scene-card__img { height: 80px; }
      .walk-panel__card { width: 170px; height: 135px; }
      .nav-circle { width: 120px; height: 120px; }
    }

    @media (max-width: 720px) {
      .tour-frame { aspect-ratio: 4/3; }
      .ui-center { transform: translate(-50%, -40%); }
      .card-row { gap: 12px; }
      .scene-card { width: 120px; }
    }


body:fullscreen .tour-overlay {   
  animation: fade 0.5s ease-out;
}

@keyframes fade{
  50%{
    opacity: 0;
  }

  0%, 100%{
    opacity: 1;
  }
}



/* 
  body:has(.icon-round input:checked) .glass-top-center,
  body:has(.icon-round input:checked) .exit,
  body:has(.icon-round input:checked) .ui-bottom,
  body:has(.icon-round input:checked) .subtitle,
  body:has(.icon-round input:checked) .cc-button-wrapper,
  body:has(.icon-round input:checked) .ui-center
  {
    display: none;
  } */
  </style>
</head>

<body>
      <!-- Panolens viewer goes inside here -->
      <div id="viewer"></div>

      <!-- overlay UI -->
      <div class="tour-overlay">

        <!-- TOP BAR -->

          <div id="out">
            <a class="exit">
              <svg width="162" height="51" viewBox="0 0 162 51" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="1.5" y="1.5" width="159" height="48" rx="8.5" fill="#00A758" stroke="white" stroke-width="3"/>
              <path d="M9.57861 22.6072C9.18808 22.9977 9.18808 23.6309 9.57861 24.0214L15.9426 30.3854C16.3331 30.7759 16.9663 30.7759 17.3568 30.3854C17.7473 29.9948 17.7473 29.3617 17.3568 28.9711L11.6999 23.3143L17.3568 17.6574C17.7473 17.2669 17.7473 16.6337 17.3568 16.2432C16.9663 15.8527 16.3331 15.8527 15.9426 16.2432L9.57861 22.6072ZM27 23.3143V22.3143L10.2857 22.3143V23.3143V24.3143L27 24.3143V23.3143Z" fill="white"/>
              <line x1="64.7856" y1="7.28571" x2="64.7856" y2="39.3429" stroke="white"/>
              <path d="M92.404 19.2935H85.9489V31.2857H83.2048V17.067H92.404V19.2935ZM102.111 28.317H97.8435L97.0036 31.2857H94.113L98.7712 17.067H101.261L105.832 31.2857H102.941L102.111 28.317ZM98.5173 25.983H101.467L100.011 20.7486L98.5173 25.983ZM110.051 26.0709V31.2857H107.306V17.067H112.17C112.944 17.067 113.644 17.1809 114.269 17.4088C114.894 17.6301 115.428 17.9394 115.871 18.3365C116.307 18.7401 116.642 19.2219 116.877 19.7818C117.118 20.3417 117.238 20.9634 117.238 21.647C117.238 22.2851 117.118 22.8743 116.877 23.4146C116.642 23.955 116.307 24.4205 115.871 24.8111C115.428 25.2082 114.894 25.5175 114.269 25.7388C113.644 25.9602 112.944 26.0709 112.17 26.0709H110.051ZM110.051 23.8443H112.17C112.56 23.8443 112.899 23.7857 113.185 23.6685C113.472 23.5513 113.713 23.3918 113.908 23.19C114.097 22.9882 114.237 22.7571 114.328 22.4967C114.426 22.2297 114.474 21.953 114.474 21.6666C114.474 21.3345 114.426 21.0253 114.328 20.7388C114.237 20.4524 114.097 20.2017 113.908 19.9869C113.713 19.772 113.472 19.6028 113.185 19.4791C112.899 19.3554 112.56 19.2935 112.17 19.2935H110.051V23.8443ZM126.134 28.317H121.867L121.027 31.2857H118.136L122.795 17.067H125.285L129.855 31.2857H126.965L126.134 28.317ZM122.541 25.983H125.49L124.035 20.7486L122.541 25.983ZM135.968 22.1646L138.498 17.067H141.72L137.717 24.1177L141.818 31.2857H138.615L136.008 26.1099L133.41 31.2857H130.168L134.269 24.1177L130.275 17.067H133.478L135.968 22.1646Z" fill="white"/>
              <path d="M33.4287 10.2H55.2859V37.8857H33.4287V10.2Z" fill="white"/>
              <path d="M40.0146 18.9427H47.9375V18.9691L51.0518 25.0823C50.7882 26.1802 50.3594 26.4195 49.2451 26.138L46.916 21.5657H44.8301L46.4902 25.9368V30.3079H57.5107C57.5371 30.3268 61.1703 32.9308 57.5107 32.931H44.041L43.3281 27.5872L39.1094 37.4915C38.0726 37.6263 37.5847 37.4116 36.9766 36.4485L41.6914 25.3802L40.3633 22.0052L38.3271 24.1878H33.4287V22.4398H36.6943L39.9834 18.9075L40.0146 18.9427ZM40.7754 12.8226C42.1279 12.8226 43.2246 13.9971 43.2246 15.4456C43.2246 16.8942 42.1279 18.0687 40.7754 18.0687C39.4231 18.0684 38.3271 16.894 38.3271 15.4456C38.3272 13.9972 39.4231 12.8228 40.7754 12.8226Z" fill="#00A758"/>
              <path d="M54.9795 37.9355L58.9854 40.75H36.7646L33.5605 37.9355H54.9795Z" fill="white" stroke="#00A758" stroke-width="0.1"/>
              <path d="M37.2856 37.8857H38.204H40.0407L43.7142 40.8H40.9591L37.2856 37.8857Z" fill="#00A758"/>
              </svg>
            </a>
          </div>

          <div class="glass-top-center">
            <div class="ui-top-center">         
                <svg width="27" height="21" viewBox="0 0 27 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M19.6758 20.1282L17.5088 20.1145V14.7844L13.3535 16.1516L13.3516 16.1458L13.3496 16.1565L9.25879 14.8274L9.25977 20.134L7.08789 20.1477L7.06055 14.1135L7.02051 14.1008L7.05957 13.9348L7.05078 11.7551L7.90723 12.0413L13.3945 13.8235L17.7754 12.3831L19.7383 11.7249L19.6758 20.1282Z" fill="white"/>
                <rect x="0.179688" y="19.0512" width="26.4302" height="1.09641" fill="white"/>
                <path d="M13.394 6.6202C15.3765 6.6202 16.6432 8.29387 16.8999 9.89071C16.932 10.0913 16.8503 10.4453 16.1304 10.8448C15.4424 11.2265 14.427 11.4727 13.394 11.4727C12.361 11.4727 11.3456 11.2266 10.6577 10.8448C9.93815 10.4454 9.85611 10.0914 9.88818 9.89071C10.1484 8.27121 11.4091 6.62036 13.394 6.6202Z" stroke="white" stroke-width="2"/>
                <path d="M13.0259 0.0822249H13.7348V6.71661L13.0259 6.71661V0.0822249Z" fill="white"/>
                <path d="M13.7344 0.0781989L17.6732 1.28561L17.6733 4.63401L13.4701 3.42737L13.7344 0.0781989Z" fill="white"/>
                <path d="M26.7642 14.2164L24.0063 15.1784L23.5562 13.6344L26.7651 12.4967L26.7642 14.2164Z" fill="white"/>
                <path d="M0.0458984 14.3942L2.90723 15.3531L3.3291 13.8365L0 12.6949L0.0458984 14.3942Z" fill="white"/>
                <path d="M24.6938 20.1491L23.4653 20.1442V10.9049L24.7739 10.4186L24.6938 20.1491Z" fill="white"/>
                <path d="M2.13477 20.1482L3.33887 20.1433L3.35352 10.9265L2.07129 10.4422L2.13477 20.1482Z" fill="white"/>
                <path d="M26.7695 20.1447H25.5479L25.5508 12.9269L26.7959 12.4728L26.7695 20.1447Z" fill="white"/>
                <path d="M0.0424805 20.1475H1.06396L1.04834 13.4434L0.00830078 13.0215L0.0424805 20.1475Z" fill="white"/>
                <path d="M22.272 20.1104L20.8003 20.1006V10.5489L13.3062 12.9317L13.3052 12.9395L4.57373 10.0303L4.9751 8.36136L13.3159 11.1387L20.8452 8.74417L22.3276 8.24613L22.272 20.1104Z" fill="white"/>
                <path d="M4.4082 8.12177L5.93581 8.64354L5.93658 20.1629L4.46427 20.1722L4.4082 8.12177Z" fill="white"/>
                <path d="M2.16553 12.0535L5.4973 13.2885L5.88404 11.8603L2.55226 10.6253L2.16553 12.0535Z" fill="white"/>
                <path d="M24.6543 12.0151L21.1705 13.3065L20.7887 11.8967L24.2725 10.6053L24.6543 12.0151Z" fill="white"/>
                </svg>
                <h2 id="place">–£–ì–¢–ê–• –•–≠–°–≠–ì</h2>
            </div>
          </div>
          <div class="static">
            <div class="glass-icon-round">
              <div class="icon-round">
                      <input type="checkbox" id="uiToggle" />
                      <label for="uiToggle">                     
                        <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect y="21" width="8.75" height="2.625" transform="rotate(-90 0 21)" fill="white"/>
                        <rect y="18.375" width="8.75" height="2.625" fill="white"/>
                        <rect width="8.75" height="2.625" fill="white"/>
                        <rect x="2.625" width="8.75" height="2.625" transform="rotate(90 2.625 0)" fill="white"/>
                        <rect x="21" width="8.75" height="2.625" transform="rotate(90 21 0)" fill="white"/>
                        <rect x="21" y="2.625" width="8.75" height="2.625" transform="rotate(180 21 2.625)" fill="white"/>
                        <rect x="21" y="21" width="8.75" height="2.625" transform="rotate(-180 21 21)" fill="white"/>
                        <rect x="18.375" y="21" width="8.75" height="2.625" transform="rotate(-90 18.375 21)" fill="white"/>
                        </svg>
                        
                      </label>       
              </div>
          </div>
          </div>

        <!-- CENTER CARDS -->
        <div class="ui-center">

        </div>

        <!-- BOTTOM -->
         
        <div class="ui-bottom">
          <div class="walk-panel">
              <div class="glass-panel">
                <!-- hidden checkbox -->
                <input type="checkbox" id="walkToggle" class="walk-toggle" />

                <!-- visual button (label for checkbox) -->
                <label for="walkToggle" class="walk">
                  <svg width="18" height="25" viewBox="0 0 18 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5.26763 2.34375C5.26763 3.63817 6.31696 4.6875 7.61138 4.6875C8.9058 4.6875 9.95513 3.63817 9.95513 2.34375C9.95513 1.04933 8.9058 0 7.61138 0C6.31696 0 5.26763 1.04933 5.26763 2.34375Z" fill="white"/>
                    <path d="M16.4688 8.5165C16.0855 7.17493 14.8593 6.25 13.464 6.25H8.80502L4.41519 8.44491L1.16042 7.143L-0.000174165 10.0445L3.2546 11.3464C4.08337 11.6779 5.01435 11.6392 5.81273 11.24L6.04712 11.1228L6.88267 14.465L5.52012 15.2436C4.30454 15.9382 3.6993 17.3566 4.03886 18.7148L5.61016 25H8.83134L7.07055 17.9569L9.72077 16.4425L11.8602 25H15.0813L11.1751 9.375H13.464L14.3569 12.5H17.6069L16.4688 8.5165Z" fill="white"/>
                  </svg>
                  <p>–Ø–≤–∞—Ö</p>
                </label>
              </div>
 
    
              <div class="glass-map">
                  <div class="map">
                    <!-- draw your path / SVG here -->
                  </div>
                  <div class="floor">1 –¥–∞–≤—Ö–∞—Ä</div>
              </div>
          </div>  
          <div class="glass-circle">
            <div class="nav-circle"></div>
          </div>
        </div>

         <!-- VIDEO CONTROLS -->
        <div class="video-controls hidden" id="videoControls">
          <button class="vc-btn" id="vcRewind">¬´ 10s</button>
          <button class="vc-btn" id="vcPlayPause">Pause</button>
          <button class="vc-btn" id="vcForward">10s ¬ª</button>

          <label class="vc-label">
            –•—É—Ä–¥:
            <select id="vcSpeed">
              <option value="0.5">0.5x</option>
              <option value="1" selected>1x</option>
              <option value="1.5">1.5x</option>
              <option value="2">2x</option>
            </select>
          </label>

          <button class="vc-btn vc-skip" id="vcSkip">–í–∏–¥–µ–æ –∞–ª–≥–∞—Å–∞—Ö</button>
        </div>

        <!-- SUBTITLE -->
        <div class="subtitle" id="subtitle">
          –¢–∞ —è–≤–∞—Ö —Ü—ç—Å–Ω –¥—ç—ç—Ä –¥–∞—Ä–∂ —Ö–∞–∞—à–∞–∞ —è–≤–∞—Ö–∞–∞ —Å–æ–Ω–≥–æ—Ö –±–æ–ª–æ–º–∂—Ç–æ–π.
        </div>

        <!-- CC BUTTON -->
        <div class="cc-button-wrapper">
          <button class="cc-button" id="btnCc">
            <div class="cc-button__inner">CC</div>
          </button>
        </div>
      </div>

  <!-- Simple JS: hook Panolens + card clicks -->
<script>
  // process polyfill ‚Äì only needed if you see "process is not defined"
  window.process = {
    env: {
      NODE_ENV: 'production',
      npm_lifecycle_event: ''
    }
  };

  // INIT PANOLENS
  const viewer = new PANOLENS.Viewer({
    container: document.getElementById('viewer'),
    autoHideControlBar: true,
    controlBar: true,
    cameraFov: 70
  });

  const scenes = {
    main: new PANOLENS.ImagePanorama('assets/main.jpg'),

    // –û–¥–æ–æ–≥–∏–π–Ω —Å—Ü–µ–Ω“Ø“Ø–¥
    library: new PANOLENS.VideoPanorama('assets/1_nomiinsan.mp4', {
      autoplay: true,
      loop: false,
      muted: true
    }),
    libraryPhoto: new PANOLENS.ImagePanorama('assets/zaal.jpg'),
    lab: new PANOLENS.VideoPanorama('assets/lab.mp4', {
      autoplay: false,
      loop: false,
      muted: true
    }),
    lecture: new PANOLENS.VideoPanorama('assets/lecture.mp4', {
      autoplay: false,
      loop: false,
      muted: true
    }),
    floors: new PANOLENS.VideoPanorama('assets/1_shat.mp4', {
      autoplay: true,
      loop: false,
      muted: true
    }),

    // --- –î–∞–≤—Ö—Ä—É—É–¥—ã–Ω –∑—É—Ä–∞–≥ ---
    floor1: new PANOLENS.ImagePanorama('assets/one.jpg'),
    floor2: new PANOLENS.ImagePanorama('assets/two.jpg'),
    floor3: new PANOLENS.ImagePanorama('assets/three.jpg'),
    floor4: new PANOLENS.ImagePanorama('assets/four.jpg'),

    // --- –®–∞—Ç–Ω—ã –≤–∏–¥–µ–æ–Ω—É—É–¥ ---
    stairs_1_2: new PANOLENS.VideoPanorama('assets/1_shat.mp4', {
      autoplay: true,
      loop: false,
      muted: true
    }),
    stairs_2_3: new PANOLENS.VideoPanorama('assets/1_shat.mp4', {
      autoplay: true,
      loop: false,
      muted: true
    }),
    stairs_3_4: new PANOLENS.VideoPanorama('assets/1_shat.mp4', {
      autoplay: true,
      loop: false,
      muted: true
    })
  };

    let currentVideoPano = null;      // —è–≥ –æ–¥–æ–æ —Ç–æ–≥–ª–æ–∂ –±–∞–π–≥–∞–∞ VideoPanorama
    let currentFloor=1;
    const videoControls  = document.getElementById('videoControls');
    const btnRew   = document.getElementById('vcRewind');
    const btnFwd   = document.getElementById('vcForward');
    const btnPlay  = document.getElementById('vcPlayPause');
    const speedSel = document.getElementById('vcSpeed');
    const btnSkip  = document.getElementById('vcSkip');


  // add all scenes once
  Object.values(scenes).forEach(p => viewer.add(p));
  setScene('main');

  // üîó DOM elements (MUST be before we use them)
  const uiCenter   = document.querySelector('.ui-center');
  const walkToggle = document.getElementById('walkToggle'); // <input id="walkToggle">
  const subtitle   = document.getElementById('subtitle');
  const btnCc      = document.getElementById('btnCc');
  const hide     = document.getElementById('uiToggle');
  // you can fullscreen whatever you want: body, #viewer, or a wrapper.
  // right now parentElement of #viewer is <body>, so:
  const fullscreenTarget = document.body;

  // SVGs as strings (reuse your existing ones)
  const iconEnter = `
    <rect y="21" width="8.75" height="2.625" transform="rotate(-90 0 21)" fill="white"/>
    <rect y="18.375" width="8.75" height="2.625" fill="white"/>
    <rect width="8.75" height="2.625" fill="white"/>
    <rect x="2.625" width="8.75" height="2.625" transform="rotate(90 2.625 0)" fill="white"/>
    <rect x="21" width="8.75" height="2.625" transform="rotate(90 21 0)" fill="white"/>
    <rect x="21" y="2.625" width="8.75" height="2.625" transform="rotate(180 21 2.625)" fill="white"/>
    <rect x="21" y="21" width="8.75" height="2.625" transform="rotate(-180 21 21)" fill="white"/>
    <rect x="18.375" y="21" width="8.75" height="2.625" transform="rotate(-90 18.375 21)" fill="white"/>
  `;

  const iconExit = `
    <rect x="12.5518" y="8.85542" width="8.85542" height="2.53448" transform="rotate(-90 12.5518 8.85542)" fill="white"/>
    <rect x="12.5518" y="6.19879" width="8.44828" height="2.65663" fill="white"/>
    <rect x="12.5518" y="12.1446" width="8.44828" height="2.65663" fill="white"/>
    <rect x="15.0864" y="12.1446" width="8.85542" height="2.53448" transform="rotate(90 15.0864 12.1446)" fill="white"/>
    <rect x="8.44824" y="12.1446" width="8.85542" height="2.53448" transform="rotate(90 8.44824 12.1446)" fill="white"/>
    <rect x="8.44824" y="14.8012" width="8.44828" height="2.65663" transform="rotate(180 8.44824 14.8012)" fill="white"/>
    <rect x="8.44824" y="8.85543" width="8.44828" height="2.65663" transform="rotate(-180 8.44824 8.85543)" fill="white"/>
    <rect x="5.91357" y="8.85543" width="8.85542" height="2.53448" transform="rotate(-90 5.91357 8.85543)" fill="white"/>
  `;


  
  function updateFsUI(isFullscreen) {
    // change icon
    const svg = hide.parentElement.querySelector('svg');
    if (svg) {
      svg.innerHTML = isFullscreen ? iconExit : iconEnter;
    }
  }

// when checkbox changes (click on label etc.)
  hide.addEventListener('change', () => {
    if (hide.checked) {
      fullscreenTarget.requestFullscreen();
    } else {
      document.exitFullscreen();
    }
  });

// keep in sync with actual fullscreen state (Esc, F11, etc.)
  document.addEventListener('fullscreenchange', () => {
    const isFs = !!document.fullscreenElement;
    // sync checkbox and UI
    hide.checked = isFs;
    updateFsUI(isFs);
  });


  function showFloorMenu() {
    const allFloors = [1, 2, 3, 4];

    // –û–¥–æ–æ–≥–∏–π–Ω –¥–∞–≤—Ö—Ä—ã–≥ —Ö–∞—Å–Ω–∞ (–∂–∏—à—ç—ç –Ω—å 1 –¥–∞–≤—Ö–∞—Ä—Ç –±–∞–π–≤–∞–ª 2,3,4 –ª –≥–∞—Ä–Ω–∞)
    const otherFloors = allFloors.filter(f => f !== currentFloor);

    uiCenter.innerHTML = `
      <div class="card-row">
        ${otherFloors.map(f => `
          <article class="scene-card" data-floor="${f}">
            <img src="assets/thumb-floor${f}.jpg" alt="${f} –¥–∞–≤—Ö–∞—Ä" class="scene-card__img" />
            <div class="scene-card__label">${f} –¥–∞–≤—Ö–∞—Ä</div>
          </article>
        `).join('')}
      </div>
    `;
  }
  function goToFloor(targetFloor) {
    // —à–∞—Ç–Ω—ã –≤–∏–¥–µ–æ–Ω—ã key-–≥ –æ–¥–æ–æ–≥–∏–π–Ω –¥–∞–≤—Ö–∞—Ä -> –∑–æ—Ä—å–∂ –±—É–π –¥–∞–≤—Ö–∞—Ä—ã–Ω –¥–∞–≥—É—É –Ω—ç—Ä–ª—ç—Å—ç–Ω:
    // scenes.stairs_1_2, scenes.stairs_2_3, ...
    const key = `stairs_${currentFloor}_${targetFloor}`;
    const stairsVideo = scenes[key];
    const floorPano = scenes[`floor${targetFloor}`];

    // –±“Ø—Ö –≤–∏–¥–µ–æ –∑–æ–≥—Å–æ–æ–Ω–æ
    Object.values(scenes).forEach(s => {
      if (s instanceof PANOLENS.VideoPanorama) {
        s.pauseVideo();
      }
    });

    // –•—ç—Ä–≤—ç—ç —à–∞—Ç–Ω—ã –≤–∏–¥–µ–æ –±–∞–π–≤–∞–ª —ç—Ö–ª—ç—ç–¥ —Ç—ç—Ä–∏–π–≥ —Ç–æ–≥–ª–æ–Ω–æ
    if (stairsVideo) {
      viewer.setPanorama(stairsVideo);
      currentVideoPano = stairsVideo;

      const v = stairsVideo.getVideoElement();
      if (v) {
        v.playbackRate = parseFloat(speedSel.value || '1');
        v.play();
      }

      // –≤–∏–¥–µ–æ control-–æ–æ —Ö–∞—Ä—É—É–ª–Ω–∞
      videoControls.classList.remove('hidden');

      // –≤–∏–¥–µ–æ –¥—É—É—Å–∞—Ö–∞–¥ —Ç—É—Ö–∞–π–Ω –¥–∞–≤—Ö–∞—Ä—ã–Ω 360 –∑—É—Ä–∞–≥ —Ä—É—É —à–∏–ª–∂–∏–Ω—ç
      stairsVideo.addEventListener('ended', function onEnded() {
        stairsVideo.removeEventListener('ended', onEnded);

        if (floorPano) {
          viewer.setPanorama(floorPano);
        }
        currentFloor = targetFloor;
        currentVideoPano = null;
        videoControls.classList.add('hidden');
      });

    } else if (floorPano) {
      // –•—ç—Ä–≤—ç—ç —à–∞—Ç–Ω—ã –≤–∏–¥–µ–æ —Ö–∏–π—Ö–≥“Ø–π –±–æ–ª —à—É—É–¥ –∑—É—Ä–∞–≥ —Ä—É—É –æ—Ä–∂ –±–æ–ª–Ω–æ
      viewer.setPanorama(floorPano);
      currentFloor = targetFloor;
      currentVideoPano = null;
      videoControls.classList.add('hidden');
    }
  }




  function setScene(id) {
    if (id == 'library') {
      document.getElementById('place').innerHTML = '–°–ü–û–†–¢ –ó–ê–ê–õ';
    } else if (id == 'lab') {
      document.getElementById('place').innerHTML = '–õ–ê–ë–û–†–ê–¢–û–†–ò';
    } else if (id == 'lecture') {
      document.getElementById('place').innerHTML = '–õ–ï–ö–¶–ò–ô–ù ”®–†”®”®';
    } else if (id.startsWith('floor')) {
      const f = id.replace('floor', '');
      document.getElementById('place').innerHTML = f + ' –î–ê–í–•–ê–†';
    } else {
      document.getElementById('place').innerHTML = '–£–ì–¢–ê–• –•–≠–°–≠–ì';
    }

    const pano = scenes[id];
    if (!pano) return;

    // –±“Ø—Ö –≤–∏–¥–µ–æ –∑–æ–≥—Å–æ–æ–Ω–æ
    Object.values(scenes).forEach(s => {
      if (s instanceof PANOLENS.VideoPanorama) {
        s.pauseVideo();
      }
    });

    viewer.setPanorama(pano);

    // === –í–∏–¥–µ–æ –±–æ–ª currentVideoPano –±–æ–ª–≥–æ–∂, control-—ã–≥ —Ö–∞—Ä—É—É–ª–Ω–∞ ===
    if (pano instanceof PANOLENS.VideoPanorama) {
      currentVideoPano = pano;
      pano.playVideo();

      // default —Ö—É—Ä–¥
      const v = pano.getVideoElement();
      if (v) {
        v.playbackRate = parseFloat(speedSel.value || '1');
      }

      videoControls.classList.remove('hidden');
    } else {
      currentVideoPano = null;
      videoControls.classList.add('hidden');
    }

    // –∏–¥—ç–≤—Ö—Ç—ç–π –∫–∞—Ä—Ç —Å–æ–ª–∏—Ö
    document.querySelectorAll('.scene-card')
      .forEach(c => c.classList.remove('scene-card--active'));

    const active = document.querySelector(`.scene-card[data-scene="${id}"]`);
    if (active) active.classList.add('scene-card--active');
  }


  // üÉè click on any card inside .ui-center (works after innerHTML changes)
  uiCenter.addEventListener('click', (e) => {
    // 1) –î–∞–≤—Ö–∞—Ä —Å–æ–Ω–≥–æ—Ö –º–µ–Ω—é–Ω–∏–π –¥–æ—Ç–æ—Ä—Ö card —É—É?
    const floorCard = e.target.closest('[data-floor]');
    if (floorCard) {
      const targetFloor = parseInt(floorCard.dataset.floor, 10);
      goToFloor(targetFloor);      // –¥–æ–æ—Ä —Ñ—É–Ω–∫—Ü –±–∏—á–Ω—ç
      walkToggle.checked = false;
      uiCenter.innerHTML = '';
      return;
    }

    // 2) –≠–Ω–≥–∏–π–Ω scene card —É—É?
    const card = e.target.closest('.scene-card');
    if (!card) return;

    const id = card.dataset.scene;

    // –•—ç—Ä—ç–≤ "–î–∞–≤—Ö–∞—Ä —Å–æ–Ω–≥–æ—Ö" –±–æ–ª —Ç—É—Å–¥–∞–∞ –º–µ–Ω—é –≥–∞—Ä–≥–∞–Ω–∞
    if (id === 'floors') {
      showFloorMenu();
      return;
    }

    // –±—É—Å–∞–¥ card-—É—É–¥ —Ö—ç–≤–∏–π–Ω –∞–∂–∏–ª–ª–∞–Ω–∞
    setScene(id);
    walkToggle.checked = false;
    uiCenter.innerHTML = '';
  });

  // ‚úÖ checkbox toggle for "–Ø–≤–∞—Ö"
  walkToggle.addEventListener('change', () => {
    if (walkToggle.checked) {
      // CHECKED ‚Üí show cards + start library video
      uiCenter.innerHTML = `
        <div class="card-row" id="sceneCards">
          <article class="scene-card" data-scene="library">
            <img src="assets/thumb-library.jpg" alt="–°–ø–æ—Ä—Ç –∑–∞–ª" class="scene-card__img" />
            <div class="scene-card__label">–ù–æ–º—ã–Ω —Å–∞–Ω</div>
          </article>

          <article class="scene-card" data-scene="lab">
            <img src="assets/thumb-lab.jpg" alt="–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏" class="scene-card__img" />
            <div class="scene-card__label">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏</div>
          </article>

          <article class="scene-card" data-scene="lecture">
            <img src="assets/thumb-lecture.jpg" alt="–õ–µ–∫—Ü" class="scene-card__img" />
            <div class="scene-card__label">–õ–µ–∫—Ü</div>
          </article>

           <!-- –®–ò–ù–≠: –î–∞–≤—Ö–∞—Ä —Å–æ–Ω–≥–æ—Ö -->
          <article class="scene-card" data-scene="floors">
            <img src="assets/one.jpg" alt="–î–∞–≤—Ö—Ä—É—É–¥" class="scene-card__img" />
            <div class="scene-card__label">–î–∞–≤—Ö–∞—Ä —Å–æ–Ω–≥–æ—Ö</div>
          </article>
        </div>
      `;

    } else {
      // UNCHECKED ‚Üí hide cards, go back to main
      uiCenter.innerHTML = '';
      setScene('main');   // <-- viewer.setPanorama –æ—Ä–Ω—ã –æ—Ä–æ–Ω–¥

      document.querySelectorAll('.scene-card')
        .forEach(c => c.classList.remove('scene-card--active'));
    }
  });

  // CC toggle (just hides/shows subtitle)
  btnCc.addEventListener('click', () => {
    const visible = subtitle.style.display !== 'none';
    subtitle.style.display = visible ? 'none' : 'block';
  });

  // üé¨ when library VIDEO finishes ‚Üí show library PHOTO
  function handleLibraryEnded() {
    console.log('Library video ended, switching to photo');
    setScene('libraryPhoto');  // photo ‚Üí non-video ‚Üí –¥–æ—Ç–æ—Ä –Ω—å ”©”©—Ä”©”© –Ω—É—É–Ω–∞
  }
  function handleFloorsEnded() {
    console.log('Floors video ended, go to floor 3 photo');
    setScene('floor3');
    }

    let floorsVideoEl = scenes.floors.getVideoElement();

    if (floorsVideoEl) {
      floorsVideoEl.addEventListener('ended', handleFloorsEnded);
    } else {
      scenes.floors.addEventListener('load', () => {
        const v = scenes.floors.getVideoElement();
        if (!v) return;
        v.addEventListener('ended', handleFloorsEnded);
      });
    }

  // try to get the video element now
  let libVideoEl = scenes.library.getVideoElement();

  if (libVideoEl) {
    // video element already exists
    libVideoEl.addEventListener('ended', handleLibraryEnded);
  } else {
    // wait until the panorama is loaded, then get the video element
    scenes.library.addEventListener('load', () => {
      libVideoEl = scenes.library.getVideoElement();
      if (!libVideoEl) return;
      libVideoEl.addEventListener('ended', handleLibraryEnded);
    });
  }
    function getCurrentVideo() {
    if (!currentVideoPano) return null;
    return currentVideoPano.getVideoElement();
  }

  // 10 —Å–µ–∫—É–Ω–¥ —É—Ö—Ä–∞–∞—Ö
  btnRew.addEventListener('click', () => {
    const v = getCurrentVideo();
    if (!v) return;
    v.currentTime = Math.max(0, v.currentTime - 10);
  });

  // 10 —Å–µ–∫—É–Ω–¥ —É—Ä–∞–≥—à–ª—É—É–ª–∞—Ö
  btnFwd.addEventListener('click', () => {
    const v = getCurrentVideo();
    if (!v) return;
    v.currentTime = Math.min(v.duration || v.currentTime + 10, v.currentTime + 10);
  });

  // Play / Pause
  btnPlay.addEventListener('click', () => {
    const v = getCurrentVideo();
    if (!v) return;
    if (v.paused) {
      v.play();
      btnPlay.textContent = 'Pause';
    } else {
      v.pause();
      btnPlay.textContent = 'Play';
    }
  });

  // –•—É—Ä–¥ —Å–æ–ª–∏—Ö
  speedSel.addEventListener('change', () => {
    const v = getCurrentVideo();
    if (!v) return;
    v.playbackRate = parseFloat(speedSel.value || '1');
  });

  // –í–∏–¥–µ–æ –∞–ª–≥–∞—Å–∞—Ö (–∂–∏—à—ç—ç –Ω—å —Å–ø–æ—Ä—Ç –∑–∞–∞–ª ‚Üí –∑—É—Ä–∞–≥ —Ä—É—É —à—É—É–¥ —à–∏–ª–∂“Ø“Ø–ª—ç—Ö)
  btnSkip.addEventListener('click', () => {
    if (!currentVideoPano) return;

    // –ù–æ–º—ã–Ω —Å–∞–Ω
    if (currentVideoPano === scenes.library) {
      setScene('libraryPhoto');

    // –õ–∞–±, –ª–µ–∫—Ü –¥—É—É—Å–≤–∞–ª –≥–æ–ª —Å—Ü—ç–Ω —Ä“Ø“Ø
    } else if (currentVideoPano === scenes.lab) {
      setScene('main');
    } else if (currentVideoPano === scenes.lecture) {
      setScene('main');

    // "floors" –∏–Ω—Ç—Ä–æ –≤–∏–¥–µ–æ (—Ö—ç—Ä–≤—ç—ç —Ö—ç—Ä—ç–≥–ª—ç–∂ –±–∞–π–≥–∞–∞ –±–æ–ª)
    } else if (currentVideoPano === scenes.floors) {
      setScene('floor3');   // 3-—Ä –¥–∞–≤—Ö—Ä—ã–Ω –∑—É—Ä–∞–≥

    // üîπ –®–ò–ù–≠: –®–∞—Ç–Ω—ã –≤–∏–¥–µ–æ–Ω—É—É–¥
    } else if (currentVideoPano === scenes.stairs_1_2) {
      setScene('floor2');   // 1‚Üí2 —à–∞—Ç ‚Üí 2-—Ä –¥–∞–≤—Ö—Ä—ã–Ω –∑—É—Ä–∞–≥
    } else if (currentVideoPano === scenes.stairs_2_3) {
      setScene('floor3');   // 2‚Üí3 —à–∞—Ç ‚Üí 3-—Ä –¥–∞–≤—Ö—Ä—ã–Ω –∑—É—Ä–∞–≥
    } else if (currentVideoPano === scenes.stairs_3_4) {
      setScene('floor4');   // 3‚Üí4 —à–∞—Ç ‚Üí 4-—Ä –¥–∞–≤—Ö—Ä—ã–Ω –∑—É—Ä–∞–≥
    }
  });


</script>
</body>
</html>
